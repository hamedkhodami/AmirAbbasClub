{% extends 'base/base.html' %}
{% load payment_extras %}
{% load humanize %}

{% block title %}Ù¾Ø±Ø¯Ø§Ø®Øªâ€ŒÙ‡Ø§ÛŒ {{ month_label }} {{ selected_year }}{% endblock %}

{% block body %}
<div class="flex flex-col items-center justify-center min-h-screen px-4 bg-gray-900 text-white">
  <div class="w-full max-w-6xl">
    <div class="text-center mb-8">
      <h2 class="text-3xl font-bold text-red-500">ğŸ’³ Ù¾Ø±Ø¯Ø§Ø®Øªâ€ŒÙ‡Ø§ÛŒ Ù…ÙˆÙÙ‚ {{ month_label }} {{ selected_year }}</h2>
    </div>

    <!-- ÙÛŒÙ„ØªØ± Ø³Ø§Ù„ -->
    <form method="get" class="flex justify-center mb-6">
      <label for="year" class="text-sm mr-2 mt-1">Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø§Ù„:</label>
      <select name="year" id="year" onchange="this.form.submit()"
              class="bg-gray-800 text-white border border-gray-600 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
        {% for year in year_choices %}
          <option value="{{ year }}" {% if year == selected_year %}selected{% endif %}>{{ year }}</option>
        {% endfor %}
      </select>
    </form>

    <!-- Ù…Ø¬Ù…ÙˆØ¹ Ø¯Ø±Ø¢Ù…Ø¯ -->
    <div class="text-center mb-6">
      <p class="text-lg font-semibold text-green-400">
        ğŸ’° Ù…Ø¬Ù…ÙˆØ¹ Ø¯Ø±Ø¢Ù…Ø¯ Ø§ÛŒÙ† Ù…Ø§Ù‡: {{ total_income|intcomma }} ØªÙˆÙ…Ø§Ù†
      </p>
    </div>

    {% if payments %}
      <!-- Ø¬Ø¯ÙˆÙ„ Ù¾Ø±Ø¯Ø§Ø®Øªâ€ŒÙ‡Ø§ -->
      <div class="overflow-x-auto rounded-lg shadow-lg border border-gray-700">
        <table class="w-full text-sm text-right text-gray-300">
          <thead class="bg-gray-700 text-gray-200 text-sm">
            <tr>
              <th class="px-4 py-3">ÙˆØ±Ø²Ø´Ú©Ø§Ø±</th>
              <th class="px-4 py-3">Ù…Ø¨Ù„Øº</th>
              <th class="px-4 py-3">ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª</th>
              <th class="px-4 py-3">Ø«Ø¨Øªâ€ŒÚ©Ù†Ù†Ø¯Ù‡</th>
              <th class="px-4 py-3">ØªÙˆØ¶ÛŒØ­Ø§Øª</th>
            </tr>
          </thead>
          <tbody class="bg-gray-900 divide-y divide-gray-800">
            {% for payment in payments %}
            <tr class="hover:bg-gray-800 transition">
              <td class="px-4 py-3 font-medium">{{ payment.user.full_name }}</td>
              <td class="px-4 py-3">{{ payment.formatted_amount }}</td>
              <td class="px-4 py-3">{{ payment.created_at_shamsi }}</td>
              <td class="px-4 py-3">{{ payment.created_by.full_name }}</td>
              <td class="px-4 py-3">{{ payment.description|default:"Ù€" }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <!-- ØµÙØ­Ù‡â€ŒØ¨Ù†Ø¯ÛŒ -->
      {% if payments.has_other_pages %}
        <div class="mt-6 flex justify-center items-center gap-4 text-sm text-gray-300">
          {% if payments.has_previous %}
            <a href="?year={{ selected_year }}&page={{ payments.previous_page_number }}"
               class="px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded-lg">â† ØµÙØ­Ù‡ Ù‚Ø¨Ù„</a>
          {% endif %}
          <span>ØµÙØ­Ù‡ {{ payments.number }} Ø§Ø² {{ payments.paginator.num_pages }}</span>
          {% if payments.has_next %}
            <a href="?year={{ selected_year }}&page={{ payments.next_page_number }}"
               class="px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded-lg">ØµÙØ­Ù‡ Ø¨Ø¹Ø¯ â†’</a>
          {% endif %}
        </div>
      {% endif %}
    {% else %}
      <p class="text-red-400 text-center mt-6">Ù‡ÛŒÚ† Ù¾Ø±Ø¯Ø§Ø®Øª Ù…ÙˆÙÙ‚ÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ù…Ø§Ù‡ Ø¯Ø± Ø³Ø§Ù„ {{ selected_year }} Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
    {% endif %}
  </div>
</div>
{% endblock %}